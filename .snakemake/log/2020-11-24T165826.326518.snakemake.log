Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cluster nodes: 1
Job counts:
	count	jobs
	1	BAM_index
	1	BAM_sort_by_position
	1	BWA_mapping
	1	TruSeq_cutadapt
	1	add_RG_tag
	1	all
	1	pick_mapped_reads
	1	pick_unmapped_reads1
	1	pick_unmapped_reads2
	1	pick_unmapped_reads3
	1	sam2bam
	11

[Tue Nov 24 16:58:26 2020]
rule TruSeq_cutadapt:
    input: ../fix.fastq/20201124-293T-DetectSeq_.CBE-V-PD7_R1.fastq.gz, ../fix.fastq/20201124-293T-DetectSeq_.CBE-V-PD7_R2.fastq.gz
    output: ../fix.fastq/20201124-293T-DetectSeq_.CBE-V-PD7_R1_cutadapt.fq.gz, ../fix.fastq/20201124-293T-DetectSeq_.CBE-V-PD7_R2_cutadapt.fq.gz
    log: ../fix.fastq/20201124-293T-DetectSeq_.CBE-V-PD7_cutadapt.log
    jobid: 1
    reason: Missing output files: ../fix.fastq/20201124-293T-DetectSeq_.CBE-V-PD7_R1_cutadapt.fq.gz, ../fix.fastq/20201124-293T-DetectSeq_.CBE-V-PD7_R2_cutadapt.fq.gz
    wildcards: date=20201124, cell=293T, seq=DetectSeq, sample=CBE-V-PD7


        /home/zhaohuanan/zhaohn_HD/miniconda3/bin/cutadapt -j 24 --times 1  -e 0.1  -O 3  --quality-cutoff 25         -m 55 -a AGATCGGAAGAGCACACGTCTGAACTCCAGTCAC         -A AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTAGATCTCGGTGGTCGCCGTATCATT         -o ../fix.fastq/20201124-293T-DetectSeq_.CBE-V-PD7_R1_cutadapt.fq.gz -p ../fix.fastq/20201124-293T-DetectSeq_.CBE-V-PD7_R2_cutadapt.fq.gz ../fix.fastq/20201124-293T-DetectSeq_.CBE-V-PD7_R1.fastq.gz ../fix.fastq/20201124-293T-DetectSeq_.CBE-V-PD7_R2.fastq.gz > ../fix.fastq/20201124-293T-DetectSeq_.CBE-V-PD7_cutadapt.log 2>&1
        
Submitted job 1 with external jobid '191907'.
[Tue Nov 24 17:24:56 2020]
Finished job 1.
1 of 11 steps (9%) done

[Tue Nov 24 17:24:56 2020]
rule BWA_mapping:
    input: ../fix.fastq/20201124-293T-DetectSeq_.CBE-V-PD7_R1_cutadapt.fq.gz, ../fix.fastq/20201124-293T-DetectSeq_.CBE-V-PD7_R2_cutadapt.fq.gz
    output: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned.out.sam
    log: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned.out.log
    jobid: 3
    reason: Missing output files: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned.out.sam; Input files updated by another job: ../fix.fastq/20201124-293T-DetectSeq_.CBE-V-PD7_R1_cutadapt.fq.gz, ../fix.fastq/20201124-293T-DetectSeq_.CBE-V-PD7_R2_cutadapt.fq.gz
    wildcards: date=20201124, cell=293T, seq=DetectSeq, sample=CBE-V-PD7


        /home/zhaohuanan/zhaohn_HD/miniconda3/bin/bwa mem         -t 24         /home/zhaohuanan/zhaohn_HD/2.database/bwa_hg38/hg38_only_chromosome.fa         ../fix.fastq/20201124-293T-DetectSeq_.CBE-V-PD7_R1_cutadapt.fq.gz         ../fix.fastq/20201124-293T-DetectSeq_.CBE-V-PD7_R2_cutadapt.fq.gz         -o ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned.out.sam  > ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned.out.log 2>&1
        
Submitted job 3 with external jobid '191908'.
[Tue Nov 24 19:14:20 2020]
Finished job 3.
2 of 11 steps (18%) done

[Tue Nov 24 19:14:21 2020]
rule sam2bam:
    input: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned.out.sam
    output: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned.out.bam
    jobid: 2
    reason: Missing output files: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned.out.bam; Input files updated by another job: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned.out.sam
    wildcards: date=20201124, cell=293T, seq=DetectSeq, sample=CBE-V-PD7


        /home/zhaohuanan/zhaohn_HD/miniconda3/bin/samtools view -@ 24 -Sbh         ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned.out.sam > ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned.out.bam
        
Submitted job 2 with external jobid '191911'.
Removing temporary output file ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned.out.sam.
[Tue Nov 24 19:18:05 2020]
Finished job 2.
3 of 11 steps (27%) done

[Tue Nov 24 19:18:05 2020]
rule add_RG_tag:
    input: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned.out.bam
    output: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned.out.fix_RG.bam
    jobid: 4
    reason: Missing output files: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned.out.fix_RG.bam; Input files updated by another job: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned.out.bam
    wildcards: date=20201124, cell=293T, seq=DetectSeq, sample=CBE-V-PD7


        /home/zhaohuanan/zhaohn_HD/miniconda3/bin/samtools addreplacerg -r '@RG\tID:CBE-V-PD7\tSM:CBE-V-PD7\tPL:ILLUMINA' -@ 24 -O BAM -o ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned.out.fix_RG.bam --reference /home/zhaohuanan/zhaohn_HD/2.database/bwa_hg38/hg38_only_chromosome.fa ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned.out.bam
        
Submitted job 4 with external jobid '191912'.
[Tue Nov 24 19:21:49 2020]
Finished job 4.
4 of 11 steps (36%) done

[Tue Nov 24 19:21:49 2020]
rule BAM_sort_by_position:
    input: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned.out.fix_RG.bam
    output: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.bam
    jobid: 5
    reason: Missing output files: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.bam; Input files updated by another job: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned.out.fix_RG.bam
    wildcards: date=20201124, cell=293T, seq=DetectSeq, sample=CBE-V-PD7


        /home/zhaohuanan/zhaohn_HD/miniconda3/bin/samtools sort         -O BAM         -o ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.bam         -T ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.bam.temp         -@ 24          ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned.out.fix_RG.bam
        
Submitted job 5 with external jobid '191913'.
[Tue Nov 24 19:30:39 2020]
Finished job 5.
5 of 11 steps (45%) done

[Tue Nov 24 19:30:39 2020]
rule pick_unmapped_reads1:
    input: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.bam
    output: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.unmapped.bam
    jobid: 8
    reason: Missing output files: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.unmapped.bam; Input files updated by another job: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.bam
    wildcards: date=20201124, cell=293T, seq=DetectSeq, sample=CBE-V-PD7


        /home/zhaohuanan/zhaohn_HD/miniconda3/bin/samtools view -@ 24 -b -f 4         ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.bam > ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.unmapped.bam
        
Submitted job 8 with external jobid '191915'.
[Tue Nov 24 19:31:50 2020]
Finished job 8.
6 of 11 steps (55%) done

[Tue Nov 24 19:31:50 2020]
rule pick_unmapped_reads2:
    input: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.unmapped.bam
    output: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.unmapped.fasta
    jobid: 7
    reason: Missing output files: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.unmapped.fasta; Input files updated by another job: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.unmapped.bam
    wildcards: date=20201124, cell=293T, seq=DetectSeq, sample=CBE-V-PD7


        /home/zhaohuanan/zhaohn_HD/miniconda3/bin/samtools view -@ 24 ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.unmapped.bam | awk '{print ">"$1"\n"$10}' > ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.unmapped.fasta
        
Submitted job 7 with external jobid '191916'.
Removing temporary output file ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.unmapped.bam.
[Tue Nov 24 19:32:21 2020]
Finished job 7.
7 of 11 steps (64%) done

[Tue Nov 24 19:32:21 2020]
rule pick_unmapped_reads3:
    input: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.unmapped.fasta
    output: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.unmapped.fasta.gz
    jobid: 6
    reason: Missing output files: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.unmapped.fasta.gz; Input files updated by another job: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.unmapped.fasta
    wildcards: date=20201124, cell=293T, seq=DetectSeq, sample=CBE-V-PD7


        pigz -p 24 ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.unmapped.fasta
        
Submitted job 6 with external jobid '191917'.
Removing temporary output file ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.unmapped.fasta.
[Tue Nov 24 19:32:42 2020]
Finished job 6.
8 of 11 steps (73%) done

[Tue Nov 24 19:32:42 2020]
rule pick_mapped_reads:
    input: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.bam
    output: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.mapped_F1804_MAPQ20.bam
    jobid: 10
    reason: Missing output files: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.mapped_F1804_MAPQ20.bam; Input files updated by another job: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.bam
    wildcards: date=20201124, cell=293T, seq=DetectSeq, sample=CBE-V-PD7


        /home/zhaohuanan/zhaohn_HD/miniconda3/bin/samtools view -@ 24 -b -F 1804 -q 20          ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.bam > ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.mapped_F1804_MAPQ20.bam
        
Submitted job 10 with external jobid '191918'.
[Tue Nov 24 19:35:45 2020]
Finished job 10.
9 of 11 steps (82%) done

[Tue Nov 24 19:35:45 2020]
rule BAM_index:
    input: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.mapped_F1804_MAPQ20.bam
    output: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.mapped_F1804_MAPQ20_rmdup.bam, ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.mapped_F1804_MAPQ20_rmdup.bam.bai
    jobid: 9
    reason: Missing output files: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.mapped_F1804_MAPQ20_rmdup.bam.bai, ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.mapped_F1804_MAPQ20_rmdup.bam; Input files updated by another job: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.mapped_F1804_MAPQ20.bam
    wildcards: date=20201124, cell=293T, seq=DetectSeq, sample=CBE-V-PD7


        /home/zhaohuanan/zhaohn_HD/miniconda3/bin/sambamba markdup --remove-duplicates --nthreads= 24 --show-progress  --sort-buffer-size 8192         ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.mapped_F1804_MAPQ20.bam ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.mapped_F1804_MAPQ20_rmdup.bam
        
Submitted job 9 with external jobid '191919'.
[Tue Nov 24 20:09:38 2020]
Finished job 9.
10 of 11 steps (91%) done

[Tue Nov 24 20:09:39 2020]
localrule all:
    input: ../fix.fastq/20201124-293T-DetectSeq_.CBE-V-PD7_R1.fastq.gz, ../fix.fastq/20201124-293T-DetectSeq_.CBE-V-PD7_R2.fastq.gz, ../fix.fastq/20201124-293T-DetectSeq_.CBE-V-PD7_R1_cutadapt.fq.gz, ../fix.fastq/20201124-293T-DetectSeq_.CBE-V-PD7_R2_cutadapt.fq.gz, ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned.out.bam, ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned.out.fix_RG.bam, ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.bam, ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.unmapped.fasta.gz, ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.mapped_F1804_MAPQ20_rmdup.bam, ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.mapped_F1804_MAPQ20_rmdup.bam.bai
    jobid: 0
    reason: Input files updated by another job: ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned.out.fix_RG.bam, ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.unmapped.fasta.gz, ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.mapped_F1804_MAPQ20_rmdup.bam.bai, ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.bam, ../fix.fastq/20201124-293T-DetectSeq_.CBE-V-PD7_R2_cutadapt.fq.gz, ../fix.fastq/20201124-293T-DetectSeq_.CBE-V-PD7_R1_cutadapt.fq.gz, ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned_sortp.mapped_F1804_MAPQ20_rmdup.bam, ../bam/20201124-293T-DetectSeq_.CBE-V-PD7_Aligned.out.bam

[Tue Nov 24 20:09:39 2020]
Finished job 0.
11 of 11 steps (100%) done
Complete log: /gpfs/user/zhaohuanan/3.project/23.2020_11_1120_CBE-HEK4-DigenomeOnly-GuideOnly_and_LZC-CBE-DetectSeqTest-VEGFA/CBE-DetectSeqTest/snakepipes_WGS_BWA-mapping/.snakemake/log/2020-11-24T165826.326518.snakemake.log
